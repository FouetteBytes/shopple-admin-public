# =============================================================================
# KUBERNETES PERSISTENT VOLUME CLAIMS (PVCs)
# =============================================================================
# 
# Defines PersistentVolumeClaims (PVCs) used by containers to retain data
# across pod restarts and deployments.
#
# WHY DO WE NEED THIS?
# --------------------
# - Container filesystems are ephemeral; data is lost on restart
# - PVCs provide persistent storage that pods can mount
# - Data stored in PVCs survives restarts and updates
#
# Working Principle:
# -------------
#   Container                    PVC (Storage)
#   ┌─────────────┐             ┌─────────────┐
#   │  Backend    │────mounts───│ backend-data│  (1Gi)
#   │  Container  │             │  /app/data  │
#   └─────────────┘             └─────────────┘
#
# LOCAL vs CLOUD:
# ---------------
# - Local (Docker Desktop/Minikube): Uses the workstation disk
# - Cloud (GKE/EKS/AKS): Uses managed cloud storage (e.g., Google Persistent Disk)
#
# =============================================================================

# -----------------------------------------------------------------------------
# BACKEND DATA STORAGE
# Stores: notes.json, user data, API key cache
# -----------------------------------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: backend-data
  labels:
    app: backend
spec:
  accessModes:
    - ReadWriteOnce      # Only one pod can write at a time
  resources:
    requests:
      storage: 1Gi       # 1 gigabyte of storage

---
# -----------------------------------------------------------------------------
# CRAWLER OUTPUT STORAGE
# Stores: Scraped product data (JSON/CSV files)
# -----------------------------------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: crawler-output
  labels:
    app: crawler
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi       # 5 gigabytes 

---
# -----------------------------------------------------------------------------
# CRAWLER CACHE STORAGE
# Stores: Temporary crawl data, HTTP cache
# -----------------------------------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: crawler-cache
  labels:
    app: crawler
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi

---
# -----------------------------------------------------------------------------
# CRAWLER JOBS STORAGE
# Stores: Job queue files, scheduled tasks
# -----------------------------------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: crawler-jobs
  labels:
    app: crawler
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi

---
# -----------------------------------------------------------------------------
# CRAWLER LOGS STORAGE
# Stores: Crawler execution logs (before shipping to OpenSearch)
# -----------------------------------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: crawler-logs
  labels:
    app: crawler
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
